<link async rel="import" href="/async-js-imports.html">
<script>
window.stampSite = function(siteName) {
  var link = document.querySelector('link[rel="import"][href="/header-imports.html"]');
  var template = link.import.querySelector('template');
  var clone = document.importNode(template.content, true);
  document.body.appendChild(clone);
  fetch('sites.json')
  .then( function(resp) { return resp.json() })
  .then(function(sites) {
    var site = sites.filter(function(site) { return site.name == siteName })[0];
    var link = document.querySelector('link[rel="import"][href="site.html"]');
    var template = link.import.querySelector('template');
    var clone = document.importNode(template.content, true);
    clone.querySelector('#street_address').innerHTML = site.street_address;
    clone.querySelector('#city_name').innerHTML = site.name;
    clone.querySelector('#sb-name').innerHTML = site.name;
    clone.querySelector('#sb-readable_location').innerHTML = site.readable_location;
    clone.querySelector('#sb-street_address').innerHTML = site.street_address;
    clone.querySelector('#sb-location_coarse').innerHTML = site.location_coarse;
    clone.querySelector('google-map').latitude = site.latitude;
    clone.querySelector('google-map').longitude = site.longitude;
    clone.querySelector('google-map-marker').latitude = site.latitude;
    clone.querySelector('google-map-marker').longitude = site.longitude;
    clone.querySelector('#mail-link').href = `mailto:${site.name.toLowerCase()}@healthhack.com.au`;
    clone.querySelector('#mail-link').innerHTML = `${site.name.toLowerCase()}@healthhack.com.au`;
    var general = sites.filter(function(site) { return site.name == 'general'})[0];
    clone.querySelector('#sb-date').innerHTML = general.date;
    document.body.appendChild(clone);
    var link = document.querySelector('link[rel="import"][href="/footer-imports.html"]');
    var template = link.import.querySelector('template');
    var clone = document.importNode(template.content, true);
    document.body.appendChild(clone);
  }.bind(this));
}
</script>
